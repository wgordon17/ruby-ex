#!/bin/bash -e
# The assemble script builds the application artifacts from source and
# places them into appropriate directories inside the image.

echo "---> Updating bundler gem..."
# disable the user install options in order to specify an install path
# in a user-owned directory and specify the directory to use for the
# binary files
gem install bundler -v "~>1.0" \
  --no-user-install  \
  --install-dir /opt/app-root/gems  \
  --bindir /opt/app-root/bin

# Update PATH to read from the above directory for binaries first
export PATH=/opt/app-root/bin:$PATH

pwd
bundle version
ls -la

# Execute the default S2I script
source ${STI_SCRIPTS_PATH}/assemble
